(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{3237:(e,s,a)=>{"use strict";a.d(s,{default:()=>u});var r=a(5155),n=a(5695),t=a(2115),o=a(8690),i=a.n(o);function u(){let e=(0,n.useSearchParams)(),s=(0,n.useRouter)(),a=e.get("email")||"",[o,u]=(0,t.useState)(""),[l,c]=(0,t.useState)(""),[d,h]=(0,t.useState)(""),[p,m]=(0,t.useState)(""),[_,g]=(0,t.useState)(!1);(0,t.useEffect)(()=>{a||h("Missing email. Please restart the reset process.")},[a]);let w=async e=>{if(e.preventDefault(),h(""),m(""),!a)return void h("Email not found. Please go back and verify OTP again.");if(o!==l)return void h("Passwords do not match.");g(!0);try{let e,r=await fetch("https://api.digitalmerkato.com.et/api/change_password/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,new_password:o,confirm_password:l})}),n=await r.text();try{e=n?JSON.parse(n):{}}catch(e){throw Error("Server returned an invalid response")}if(!r.ok)throw Error(e.message||"Password change failed");m("Password changed successfully! Redirecting to login..."),setTimeout(()=>{s.push("/login")},2e3)}catch(e){h(e instanceof Error?e.message:"Something went wrong. Please try again.")}finally{g(!1)}};return(0,r.jsxs)("div",{className:i().container,children:[(0,r.jsx)("h2",{className:i().header,children:"Change Password"}),d&&(0,r.jsx)("p",{className:i().error,children:d}),p&&(0,r.jsx)("p",{className:i().success,children:p}),(0,r.jsxs)("form",{onSubmit:w,className:i().form,children:[(0,r.jsxs)("div",{className:i().inputGroup,children:[(0,r.jsx)("label",{className:i().label,children:"New Password"}),(0,r.jsx)("input",{type:"password",className:i().input,value:o,onChange:e=>u(e.target.value),placeholder:"Enter new password",required:!0,minLength:6})]}),(0,r.jsxs)("div",{className:i().inputGroup,children:[(0,r.jsx)("label",{className:i().label,children:"Confirm Password"}),(0,r.jsx)("input",{type:"password",className:i().input,value:l,onChange:e=>c(e.target.value),placeholder:"Confirm new password",required:!0,minLength:6})]}),(0,r.jsx)("button",{type:"submit",className:i().button,disabled:_,children:_?"Changing...":"Change Password"})]})]})}},3948:(e,s,a)=>{Promise.resolve().then(a.bind(a,3237))},5695:(e,s,a)=>{"use strict";var r=a(8999);a.o(r,"useRouter")&&a.d(s,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(s,{useSearchParams:function(){return r.useSearchParams}})},8690:e=>{e.exports={container:"ChangePassword_container__OnbZj",header:"ChangePassword_header__Y_hwV",error:"ChangePassword_error__MIpvf",success:"ChangePassword_success__h9uNy",form:"ChangePassword_form__eQqkU",inputGroup:"ChangePassword_inputGroup__qJaml",label:"ChangePassword_label__3CP3A",input:"ChangePassword_input__H5463",button:"ChangePassword_button__2iGbY"}}},e=>{var s=s=>e(e.s=s);e.O(0,[497,441,684,358],()=>s(3948)),_N_E=e.O()}]);