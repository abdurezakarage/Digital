(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{5695:(e,a,r)=>{"use strict";var s=r(8999);r.o(s,"useRouter")&&r.d(a,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(a,{useSearchParams:function(){return s.useSearchParams}})},5773:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>l});var s=r(5155),t=r(2115),n=r(5695),o=r(8018),i=r.n(o);function l(){let e=(0,n.useRouter)(),[a,r]=(0,t.useState)(""),[o,l]=(0,t.useState)(""),[u,c]=(0,t.useState)(null),[d,p]=(0,t.useState)(!1),g=async r=>{r.preventDefault(),c(null),p(!0);try{let r=await fetch("https:/api.digitalmerkato.com.et/api/token/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,password:o})});if(!r.ok)throw Error("Invalid username or password");let s=await r.json(),t=function(e){try{let a=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(a).split("").map(e=>"%"+e.charCodeAt(0).toString(16).padStart(2,"0")).join(""));return JSON.parse(r)}catch(e){return null}}(s.access);(null==t?void 0:t.role)==="admin"?(localStorage.setItem("accessToken",s.access),e.push("/admin")):c("You do not have admin access")}catch(e){c(e.message||"Login failed")}finally{p(!1)}};return(0,s.jsxs)("div",{className:i().container,children:[(0,s.jsx)("h2",{className:i().header,children:"Admin Login"}),u&&(0,s.jsx)("p",{className:i().error,children:u}),(0,s.jsxs)("form",{onSubmit:g,className:i().form,children:[(0,s.jsxs)("div",{className:i().inputGroup,children:[(0,s.jsx)("label",{className:i().label,children:"Username"}),(0,s.jsx)("input",{type:"text",value:a,onChange:e=>r(e.target.value),placeholder:"Enter your username",required:!0,className:i().input})]}),(0,s.jsxs)("div",{className:i().inputGroup,children:[(0,s.jsx)("label",{className:i().label,children:"Password"}),(0,s.jsx)("input",{type:"password",value:o,onChange:e=>l(e.target.value),placeholder:"Enter your password",required:!0,className:i().input})]}),(0,s.jsx)("button",{type:"submit",className:i().button,disabled:d,children:d?"Logging in...":"Login"})]}),(0,s.jsx)("p",{style:{textAlign:"center",marginTop:"1rem"},children:(0,s.jsx)("a",{href:"/login/forgot-password/",className:i()["forgot-password"],children:"forgot password?"})})]})}},5975:(e,a,r)=>{Promise.resolve().then(r.bind(r,5773))},8018:e=>{e.exports={container:"LoginPage_container__fj2Xh",header:"LoginPage_header__pPziJ",error:"LoginPage_error__WcRRP",form:"LoginPage_form__IGzlI",inputGroup:"LoginPage_inputGroup__UKuCg",label:"LoginPage_label__htgeY",input:"LoginPage_input__AZUzS",button:"LoginPage_button__Aj_wD","forgot-password":"LoginPage_forgot-password__e2V8I"}}},e=>{var a=a=>e(e.s=a);e.O(0,[705,441,684,358],()=>a(5975)),_N_E=e.O()}]);